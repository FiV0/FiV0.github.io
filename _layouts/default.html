<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  {% include head.html %}

  <body>

    <div class="container content">
      <div class="masthead">
        <div class="masthead-header">
          <h3 class="masthead-title">
            <a href="/" title="Home">{{ site.title }}</a>

            {% for page in site.pages_list %}
                &nbsp;&nbsp;&nbsp;<small><a href="{{ page[1]  }}">{{ page[0] }}</a></small>
            {% endfor %}
          </h3>
          <span class="social-buttons">
            <a href="https://github.com/fiv0" target="_blank" class="social-button github-button">
              <i class="fab fa-github"></i>
            </a>
            <a href="https://twitter.com/_fiv0" target="_blank" class="social-button twitter-button">
              <i class="fab fa-twitter"></i>
            </a>
            <a href="https://bsky.app/profile/fivo.bsky.social" target="_blank" class="social-button bluesky-button">
              <i class="fa-brands fa-bluesky"></i>
            </a>
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
              <i class="fas fa-moon" id="theme-icon"></i>
            </button>
          </span>
        </div>

      </div>

      {{ content }}

      {% include comments.html %}

      <div class="footer">
        <p>
          &copy; {{ site.time | date: '%Y' }}. All rights reserved.
        </p>
      </div>
    </div>

    <script>
      (function() {
        var toggle = document.getElementById('theme-toggle');
        var icon = document.getElementById('theme-icon');

        function getTheme() {
          return document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
        }

        function setTheme(theme) {
          if (theme === 'dark') {
            document.documentElement.setAttribute('data-theme', 'dark');
            icon.classList.remove('fa-moon');
            icon.classList.add('fa-sun');
          } else {
            document.documentElement.removeAttribute('data-theme');
            icon.classList.remove('fa-sun');
            icon.classList.add('fa-moon');
          }
          localStorage.setItem('theme', theme);

          // Update Giscus theme
          var giscusFrame = document.querySelector('iframe.giscus-frame');
          if (giscusFrame) {
            giscusFrame.contentWindow.postMessage({
              giscus: {
                setConfig: {
                  theme: theme === 'dark' ? 'dark' : 'light'
                }
              }
            }, 'https://giscus.app');
          }
        }

        // Set initial icon state
        if (getTheme() === 'dark') {
          icon.classList.remove('fa-moon');
          icon.classList.add('fa-sun');
        }

        toggle.addEventListener('click', function() {
          var currentTheme = getTheme();
          setTheme(currentTheme === 'dark' ? 'light' : 'dark');
        });
      })();
    </script>
  </body>
</html>
